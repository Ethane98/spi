GXX        = g++
RM         = rm -f

all: $(AGENT_NAME)

AGENT_DIR      = ../
AGENT_OBJS    += $(notdir $(AGENT_SRCS:%.C=%.o))

AGENT_DEP  = .AGENT_DEPENDS
$(shell if test -f $(AGENT_DEP); then true; else \
$(GXX) -MM $(AG_IFLAGS) $(AG_FLAGS) $(AGENT_SRCS) > $(AGENT_DEP);\
fi);\
include $(AGENT_DEP)

$(AGENT_OBJS): %.o : $(AGENT_DIR)/%.C
	@echo Compiling $*.C
	@$(GXX) -c -o $@ $(AG_IFLAGS) $(AG_FLAGS) $(AGENT_DIR)/$*.C 

$(AGENT_NAME): $(AGENT_OBJS)
	@echo Linking $@
	@$(GXX) -o $@  $(AGENT_OBJS) $(SP_DIR)/$(PLATFORM)/libagent.a  $(AG_AR) -shared

#==============================================
# clean up
#==============================================
clean:
	@$(RM) *.o *.so $(AGENT_DEP)
